

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>OpenMM &mdash; NanoVer 0.1.2760 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=23fdb008" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=23fdb008" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=78662142"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=f281be69"></script>
      <script src="../_static/custom.js?v=6d5f2585"></script>
      <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Concepts" href="../concepts/concepts.html" />
    <link rel="prev" title="MDAnalysis" href="mdanalysis.html" />
 
<link rel="icon" type="image/x-icon" href="../_static/favicon.ico">
<link rel="icon" type="image/png" sizes="32x32" href="../_static/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../_static/favicon-16x16.png">
<link rel="apple-touch-icon" sizes="180x180" href="../_static/favicon.png">
<link rel="mask-icon" href="../_static/favicon.svg" color="#5bbad5">

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            NanoVer
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../highlights.html">Highlights</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation &amp; Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="tutorials.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="basics.html">NanoVer Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="vrclient.html">NanoVer iMD-VR</a></li>
<li class="toctree-l2"><a class="reference internal" href="fundamentals.html">NanoVer Fundamentals</a></li>
<li class="toctree-l2"><a class="reference internal" href="ase.html">ASE: Atomic Simulation Environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="mdanalysis.html">MDAnalysis</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">OpenMM</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#jupyter-notebook-tutorials">Jupyter notebook tutorials</a></li>
<li class="toctree-l3"><a class="reference internal" href="#nanover-openmm-xml-files">NanoVer OpenMM XML files</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#xml-structure">XML structure</a></li>
<li class="toctree-l4"><a class="reference internal" href="#components-description">Components description</a></li>
<li class="toctree-l4"><a class="reference internal" href="#usage">Usage</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tutorials.html#tips-for-using-nanover-in-jupyter">Tips for using NanoVer in Jupyter</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials.html#further-reading">Further reading</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../concepts/concepts.html">Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../citations.html">How to Cite NanoVer</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">NanoVer</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="tutorials.html">Tutorials</a></li>
      <li class="breadcrumb-item active">OpenMM</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/tutorials/openmm.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="openmm">
<h1>OpenMM<a class="headerlink" href="#openmm" title="Link to this heading"></a></h1>
<nav class="contents local" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#jupyter-notebook-tutorials" id="id1">Jupyter notebook tutorials</a></p></li>
<li><p><a class="reference internal" href="#nanover-openmm-xml-files" id="id2">NanoVer OpenMM XML files</a></p>
<ul>
<li><p><a class="reference internal" href="#xml-structure" id="id3">XML structure</a></p></li>
<li><p><a class="reference internal" href="#components-description" id="id4">Components description</a></p></li>
<li><p><a class="reference internal" href="#usage" id="id5">Usage</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="jupyter-notebook-tutorials">
<h2><a class="toc-backref" href="#id1" role="doc-backlink">Jupyter notebook tutorials</a><a class="headerlink" href="#jupyter-notebook-tutorials" title="Link to this heading"></a></h2>
<p>A set of tutorials that demonstrate how to use NanoVer to run interactive molecular
dynamics simulations using OpenMM directly.</p>
<p>The Jupyter notebook tutorials that demonstrate how to run interactive molecular
dynamics simulations by interfacing NanoVer with OpenMM directly can be found in
the <a class="reference external" href="https://github.com/IRL2/nanover-server-py/tree/main/examples/openmm">examples</a>
folder of the GitHub repository. It contains:</p>
<ul class="simple">
<li><p><cite>openmm_polyalanine</cite>: A notebook that demonstrates how to set up an interactive
OpenMM simulation from scratch with NanoVer, use features of OpenMM in conjunction
with NanoVer, and record &amp; playback simulations directly using NanoVer.</p></li>
<li><p><cite>openmm_nanotube</cite>: A notebook that demonstrates how to interact with an OpenMM
NanoVer simulation using a python client.</p></li>
<li><p><cite>openmm_neuraminidase</cite>: A notebook that demonstrates how to set up an interactive
OpenMM simulation from scratch with NanoVer and change the visualisations of
different atom selections for a protein-ligand system.</p></li>
</ul>
</section>
<section id="nanover-openmm-xml-files">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">NanoVer OpenMM XML files</a><a class="headerlink" href="#nanover-openmm-xml-files" title="Link to this heading"></a></h2>
<p>The XML format described here is used specifically for saving and loading NanoVer OpenMM simulations. It consists of a root element <code class="docutils literal notranslate"><span class="pre">&lt;OpenMMSimulation&gt;</span></code> containing three main components:</p>
<ol class="arabic simple">
<li><p><strong>Starting Structure</strong>: Enclosed in either <code class="docutils literal notranslate"><span class="pre">&lt;pdbx&gt;</span></code> or <code class="docutils literal notranslate"><span class="pre">&lt;pdb&gt;</span></code> tags</p></li>
<li><p><strong>OpenMM Serialized System</strong>: Enclosed in the <code class="docutils literal notranslate"><span class="pre">&lt;System&gt;</span></code> tag</p></li>
<li><p><strong>OpenMM Serialized Integrator</strong>: Enclosed in the <code class="docutils literal notranslate"><span class="pre">&lt;Integrator&gt;</span></code> tag</p></li>
<li><p><strong>OpenMM Serialized State</strong>: Enclosed in the <code class="docutils literal notranslate"><span class="pre">&lt;State&gt;</span></code> tag (optional)</p></li>
</ol>
<section id="xml-structure">
<h3><a class="toc-backref" href="#id3" role="doc-backlink">XML structure</a><a class="headerlink" href="#xml-structure" title="Link to this heading"></a></h3>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>&lt;OpenMMSimulation&gt;
    &lt;pdbx&gt;
        &lt;!-- Content of the PDBx file --&gt;
    &lt;/pdbx&gt;
    &lt;System ...&gt;
        &lt;!-- XML content of the OpenMM serialized system --&gt;
    &lt;/System&gt;
    &lt;Integrator ...&gt;
        &lt;!-- XML content of the OpenMM serialized integrator --&gt;
    &lt;/Integrator&gt;
    &lt;State ...&gt;
        &lt;!-- XML content of the OpenMM serialized state --&gt;
    &lt;/State&gt;
&lt;/OpenMMSimulation&gt;
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There is a slight difference between the OpenMM format and the NanoVer format.
NanoVer xml files for OpenMM simulations contain a PDB and a number of serialized objects.
Although the serialized objects are identical to those used by OpenMM, the overall contents and structure of the files are specific to NanoVer and cannot be read by OpenMM on its own.</p>
</div>
</section>
<section id="components-description">
<h3><a class="toc-backref" href="#id4" role="doc-backlink">Components description</a><a class="headerlink" href="#components-description" title="Link to this heading"></a></h3>
<section id="starting-structure">
<h4>1. <strong>Starting structure</strong>:<a class="headerlink" href="#starting-structure" title="Link to this heading"></a></h4>
<blockquote>
<div><ul class="simple">
<li><p>Tag: <code class="docutils literal notranslate"><span class="pre">&lt;pdbx&gt;</span></code> (preferred) or <code class="docutils literal notranslate"><span class="pre">&lt;pdb&gt;</span></code> (for backward compatibility)</p></li>
<li><p>Content: The entire PDBx or PDB file content</p></li>
</ul>
</div></blockquote>
</section>
<section id="openmm-serialized-system">
<h4>2. <strong>OpenMM serialized system</strong>:<a class="headerlink" href="#openmm-serialized-system" title="Link to this heading"></a></h4>
<p>Within this tag, you’ll find:</p>
<blockquote>
<div><p><strong>Particles:</strong> They are represented with <code class="docutils literal notranslate"><span class="pre">&lt;Particle&gt;</span></code> tags, each containing:</p>
<blockquote>
<div><ul class="simple">
<li><p>Mass</p></li>
<li><p>Charge (if using a <cite>NonbondedForce</cite>)</p></li>
</ul>
</div></blockquote>
<p><strong>Forces:</strong> Various force components are represented by specific tags (a detailed list could be found in this <a class="reference external" href="http://docs.openmm.org/latest/userguide/theory/02_standard_forces.html#standard-forces">link</a>), for example:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;HarmonicBondForce&gt;</span></code>: For bond stretching</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;HarmonicAngleForce&gt;</span></code>: For angle bending</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;PeriodicTorsionForce&gt;</span></code>: For dihedral angles</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;NonbondedForce&gt;</span></code>: For electrostatic and van der Waals interactions</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;CustomNonbondedForce&gt;</span></code>: For user-defined nonbonded interactions</p></li>
</ul>
<p>Each force tag contains parameters specific to that force type. For example:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;HarmonicBondForce&gt;</span>
<span class="w">  </span><span class="nt">&lt;Bond</span><span class="w"> </span><span class="na">p1=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">p2=</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="na">length=</span><span class="s">&quot;0.1&quot;</span><span class="w"> </span><span class="na">k=</span><span class="s">&quot;1000&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/HarmonicBondForce&gt;</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>Constraints:</strong> If present, constraints are listed under a <code class="docutils literal notranslate"><span class="pre">&lt;Constraints&gt;</span></code> tag:</p>
<blockquote>
<div><div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;Constraints&gt;</span>
<span class="w">  </span><span class="nt">&lt;Constraint</span><span class="w"> </span><span class="na">p1=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">p2=</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="na">distance=</span><span class="s">&quot;0.1&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/Constraints&gt;</span>
</pre></div>
</div>
</div></blockquote>
</div></blockquote>
</section>
<section id="openmm-serialized-integrator">
<h4>3. <strong>OpenMM serialized integrator</strong>:<a class="headerlink" href="#openmm-serialized-integrator" title="Link to this heading"></a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">&lt;Integrator&gt;</span></code> tag contains parameters that specify the integration method to be used to simulate dynamics, such as the type of integrator, simulation time step and temperature:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;Integrator</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;LangevinIntegrator&quot;</span><span class="w"> </span><span class="na">constraintTolerance=</span><span class="s">&quot;1e-05&quot;</span><span class="w"> </span><span class="na">friction=</span><span class="s">&quot;4&quot;</span><span class="w"> </span><span class="na">randomSeed=</span><span class="s">&quot;0&quot;</span><span class="w"> </span><span class="na">stepSize=</span><span class="s">&quot;.0005&quot;</span><span class="w"> </span><span class="na">temperature=</span><span class="s">&quot;300&quot;</span><span class="w"> </span><span class="na">version=</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
</pre></div>
</div>
<p>More details on integrators can be found <a class="reference external" href="http://docs.openmm.org/latest/userguide/theory/04_integrators.html">here</a>.</p>
</section>
<section id="openmm-serialized-state">
<h4>4. <strong>OpenMM serialized state</strong>:<a class="headerlink" href="#openmm-serialized-state" title="Link to this heading"></a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">&lt;State&gt;</span></code> tag contains the serialized state of the simulation, including:</p>
<ul class="simple">
<li><p>Particle velocities <code class="docutils literal notranslate"><span class="pre">&lt;Velocities&gt;</span></code></p></li>
<li><p>Adjustable parameters that have been defined by Force objects in the System <code class="docutils literal notranslate"><span class="pre">&lt;Parameters&gt;</span></code></p></li>
<li><p>Periodic box vectors (if periodic boundary conditions are used) <code class="docutils literal notranslate"><span class="pre">&lt;PeriodicBoxVectors&gt;</span></code></p></li>
<li><p>Integrator parameters <code class="docutils literal notranslate"><span class="pre">&lt;IntegratorParameters&gt;</span></code></p></li>
</ul>
</section>
</section>
<section id="usage">
<h3><a class="toc-backref" href="#id5" role="doc-backlink">Usage</a><a class="headerlink" href="#usage" title="Link to this heading"></a></h3>
<p>The <a class="reference internal" href="../python/nanover.openmm.serializer.html#module-nanover.openmm.serializer" title="nanover.openmm.serializer"><code class="xref py py-mod docutils literal notranslate"><span class="pre">nanover.openmm.serializer</span></code></a> module provides the <code class="docutils literal notranslate"><span class="pre">serialize_simulation</span></code> and <code class="docutils literal notranslate"><span class="pre">deserialize_simulation</span></code> functions which allow saving and loading OpenMM simulations to/from XML files. The serialization captures by default the complete simulation including:</p>
<ul class="simple">
<li><p>Structure coordinates and topology (as PDBx/PDB)</p></li>
<li><p>OpenMM System definition</p></li>
<li><p>Integrator configuration</p></li>
<li><p>Serialized state (optional)</p></li>
</ul>
<section id="serializing-a-simulation">
<h4>Serializing a simulation<a class="headerlink" href="#serializing-a-simulation" title="Link to this heading"></a></h4>
<p>To save a simulation to a NanoVer OpenMM XML:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">xml_string</span> <span class="o">=</span> <span class="n">nanover</span><span class="o">.</span><span class="n">openmm</span><span class="o">.</span><span class="n">serializer</span><span class="o">.</span><span class="n">serialize_simulation</span><span class="p">(</span><span class="n">simulation</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;sim.xml&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">xml_string</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">serialize_simulation</span></code> function accepts optional arguments:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">save_state</span></code>: Whether to include the serialized state in the XML (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>)</p></li>
</ul>
</section>
<section id="deserializing-a-simulation">
<h4>Deserializing a simulation<a class="headerlink" href="#deserializing-a-simulation" title="Link to this heading"></a></h4>
<p>To load a simulation from a NanoVer OpenMM XML:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;sim.xml&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">simulation</span> <span class="o">=</span> <span class="n">nanover</span><span class="o">.</span><span class="n">openmm</span><span class="o">.</span><span class="n">serializer</span><span class="o">.</span><span class="n">deserialize_simulation</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">deserialize_simulation</span></code> function accepts optional arguments:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">imd_force</span></code>: A CustomExternalForce for interactive molecular dynamics</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">platform_name</span></code>: The parallel computing platform for OpenMM to use (e.g. “CUDA”, “OpenCL”)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ignore_state</span></code>: Whether to ignore the serialized state in the XML (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>)</p></li>
</ul>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">simulation</span> <span class="o">=</span> <span class="n">nanover</span><span class="o">.</span><span class="n">openmm</span><span class="o">.</span><span class="n">serializer</span><span class="o">.</span><span class="n">deserialize_simulation</span><span class="p">(</span>
    <span class="n">xml_string</span><span class="p">,</span>
    <span class="n">platform_name</span><span class="o">=</span><span class="s2">&quot;CUDA&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<p>For more details, refer to our <a class="reference external" href="https://github.com/IRL2/nanover-server-py/blob/main/examples/openmm/openmm_polyalanine.ipynb">example notebook</a> on saving OpenMM systems to NanoVer OpenMM XML files.</p>
</section>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="mdanalysis.html" class="btn btn-neutral float-left" title="MDAnalysis" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../concepts/concepts.html" class="btn btn-neutral float-right" title="Concepts" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Intangible Realities Lab | University of Santiago de Compostela | University of Bristol | and other contributors. Last updated on Fri, 13 Dec 2024 15:17:41 UTC.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>